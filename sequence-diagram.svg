<?xml version="1.0" encoding="utf-8" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 20010904//EN" "http://www.w3.org/TR/2001/REC-SVG-20010904/DTD/svg10.dtd"><svg xmlns="http://www.w3.org/2000/svg" width="750" height="479" xmlns:xlink="http://www.w3.org/1999/xlink"><source><![CDATA[Note left of NowSh: Starting
NowSh->Vault: Hello(nonce, env)
Vault->NowAPI: Valid(env)
NowAPI-->Vault: OK (or not)
Note left of Vault: If OK
Vault-->NowSh: Send secrets\n and nonce
Note left of NowSh: Got nonce back?\n If so, initialize with secrets
]]></source><desc>Created with RaphaÃ«l 2.1.2</desc><defs><path id="raphael-marker-block" d="M5,0 0,2.5 5,5z" stroke-linecap="round"></path><marker refY="2.5" refX="2.5" orient="auto" markerWidth="5" markerHeight="5" id="raphael-marker-endblock55-obj2724"><use stroke="none" fill="#000" stroke-width="1.0000" transform="rotate(180 2.5 2.5) scale(1,1)" xlink:href="#raphael-marker-block"></use></marker><marker refY="2.5" refX="2.5" orient="auto" markerWidth="5" markerHeight="5" id="raphael-marker-endblock55-obj2727"><use stroke="none" fill="#000" stroke-width="1.0000" transform="rotate(180 2.5 2.5) scale(1,1)" xlink:href="#raphael-marker-block"></use></marker><marker refY="2.5" refX="2.5" orient="auto" markerWidth="5" markerHeight="5" id="raphael-marker-endblock55-obj2730"><use stroke="none" fill="#000" stroke-width="1.0000" transform="rotate(180 2.5 2.5) scale(1,1)" xlink:href="#raphael-marker-block"></use></marker><marker refY="2.5" refX="2.5" orient="auto" markerWidth="5" markerHeight="5" id="raphael-marker-endblock55-obj2736"><use stroke="none" fill="#000" stroke-width="1.0000" transform="rotate(180 2.5 2.5) scale(1,1)" xlink:href="#raphael-marker-block"></use></marker></defs><rect stroke-width="2" style="" stroke="#000000" fill="none" ry="0" rx="0" height="39" width="70" y="20" x="325"></rect><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="19" width="50" y="30" x="335"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="39.5" x="360" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="5.5">NowSh</tspan></text><rect stroke-width="2" style="" stroke="#000000" fill="none" ry="0" rx="0" height="39" width="70" y="420.4000015258789" x="325"></rect><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="19" width="50" y="430.3999938964844" x="335"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="439.9000015258789" x="360" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="5.500007629394531">NowSh</tspan></text><path stroke-width="2" d="M360,59L360,420.4000015258789" stroke="#000000" fill="none" style=""></path><rect stroke-width="2" style="" stroke="#000000" fill="none" ry="0" rx="0" height="39" width="70" y="20" x="515"></rect><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="19" width="50" y="30" x="525"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="39.5" x="550" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="5.5">Vault</tspan></text><rect stroke-width="2" style="" stroke="#000000" fill="none" ry="0" rx="0" height="39" width="70" y="420.4000015258789" x="515"></rect><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="19" width="50" y="430.3999938964844" x="525"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="439.9000015258789" x="550" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="5.500007629394531">Vault</tspan></text><path stroke-width="2" d="M550,59L550,420.4000015258789" stroke="#000000" fill="none" style=""></path><rect stroke-width="2" style="" stroke="#000000" fill="none" ry="0" rx="0" height="39" width="80" y="20" x="640"></rect><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="19" width="60" y="30" x="650"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="39.5" x="680" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="5.5">NowAPI</tspan></text><rect stroke-width="2" style="" stroke="#000000" fill="none" ry="0" rx="0" height="39" width="80" y="420.4000015258789" x="640"></rect><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="19" width="60" y="430.3999938964844" x="650"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="439.9000015258789" x="680" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="5.500007629394531">NowAPI</tspan></text><path stroke-width="2" d="M680,59L680,420.4000015258789" stroke="#000000" fill="none" style=""></path><rect stroke-width="2" style="" stroke="#000000" fill="none" ry="0" rx="0" height="29" width="90" y="79" x="250"></rect><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="19" width="80" y="84" x="255"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="93.5" x="295" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="5.5">Starting</tspan></text><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="19" width="170" y="123.5" x="370"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="133" x="455" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="5.5">Hello(nonce, env)</tspan></text><path stroke-dasharray="0" marker-end="url(#raphael-marker-endblock55-obj2724)" stroke-width="2" d="M360,147C360,147,514.9538487195969,147,544.9912891208078,147" stroke="#000000" fill="none" style=""></path><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="19" width="100" y="162.5" x="565"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="172" x="615" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="5.5">Valid(env)</tspan></text><path stroke-dasharray="0" marker-end="url(#raphael-marker-endblock55-obj2727)" stroke-width="2" d="M550,186C550,186,651.1484843492508,186,675.0033270937274,186" stroke="#000000" fill="none" style=""></path><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="19" width="110" y="201.5" x="560"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="211" x="615" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="5.5">OK (or not)</tspan></text><path stroke-dasharray="6,2" marker-end="url(#raphael-marker-endblock55-obj2730)" stroke-width="2" d="M680,225C680,225,578.8515156507492,225,554.9966729062726,225" stroke="#000000" fill="none" style=""></path><rect stroke-width="2" style="" stroke="#000000" fill="none" ry="0" rx="0" height="29" width="60" y="245" x="470"></rect><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="19" width="50" y="250" x="475"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="259.5" x="500" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="5.5">If OK</tspan></text><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="38.20001220703125" width="120" y="279.8999938964844" x="395"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="299" x="455" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="-4.100006103515625">Send secrets</tspan><tspan x="455" dy="19.2"> and nonce</tspan></text><path stroke-dasharray="6,2" marker-end="url(#raphael-marker-endblock55-obj2736)" stroke-width="2" d="M550,332.20000076293945C550,332.20000076293945,395.04615128040314,332.20000076293945,365.0087108791922,332.20000076293945" stroke="#000000" fill="none" style=""></path><rect stroke-width="2" style="" stroke="#000000" fill="none" ry="0" rx="0" height="48.20000076293945" width="320" y="352.20000076293945" x="20"></rect><rect style="" stroke="none" fill="#ffffff" ry="0" rx="0" height="38.20001220703125" width="310" y="357.1999816894531" x="25"></rect><text fill="#000000" stroke="none" font-size="16px" font-family="Andale Mono, monospace" text-anchor="middle" y="376.3000011444092" x="180" style="text-anchor: middle; font-family: Andale Mono,monospace; font-size: 16px;"><tspan dy="-4.099992752075195">Got nonce back?</tspan><tspan x="180" dy="19.2"> If so, initialize with secrets</tspan></text></svg>